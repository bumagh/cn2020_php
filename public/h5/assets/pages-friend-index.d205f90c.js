import{W as e,o as t,c as a,w as l,r as i,n,i as s,a4 as r,p as o,f as d,e as c,d as u,g as h,t as f,h as p,O as y,am as g,I as m,j as _,x as b,l as k,y as v,B as C,k as x,D as w,a as F,F as S,b as B,u as I,z as A}from"./index-be7fe8a3.js";import{_ as V}from"./uni-icons.43709c62.js";import{r as $}from"./uni-app.es.63fa007f.js";import{_ as D}from"./uni-badge.81b1303d.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as T}from"./uni-list-chat.0ac62b4d.js";import{_ as j}from"./uni-list.d1919617.js";import{_ as z}from"./uni-card.431afcaf.js";import{_ as H}from"./uni-section.f9bbaa6a.js";import{_ as R}from"./uni-drawer.7c790caa.js";import{p as W}from"./util.ff018e21.js";const N=e=>"number"==typeof e?e+"px":e;const L=U({name:"UniNavBar",components:{statusBar:U({name:"UniStatusBar",data:()=>({statusBarHeight:20}),mounted(){this.statusBarHeight=e().statusBarHeight+"px"}},[["render",function(e,r,o,d,c,u){const h=s;return t(),a(h,{style:n({height:c.statusBarHeight}),class:"uni-status-bar"},{default:l((()=>[i(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}],["__scopeId","data-v-40847dd0"]])},emits:["clickLeft","clickRight","clickTitle"],props:{dark:{type:Boolean,default:!1},title:{type:String,default:""},leftText:{type:String,default:""},rightText:{type:String,default:""},leftIcon:{type:String,default:""},rightIcon:{type:String,default:""},fixed:{type:[Boolean,String],default:!1},color:{type:String,default:""},backgroundColor:{type:String,default:""},statusBar:{type:[Boolean,String],default:!1},shadow:{type:[Boolean,String],default:!1},border:{type:[Boolean,String],default:!0},height:{type:[Number,String],default:44},leftWidth:{type:[Number,String],default:60},rightWidth:{type:[Number,String],default:60},stat:{type:[Boolean,String],default:""}},computed:{themeBgColor(){return this.dark?this.backgroundColor?this.backgroundColor:this.dark?"#333":"#FFF":this.backgroundColor||"#FFF"},themeColor(){return this.dark?this.color?this.color:this.dark?"#fff":"#333":this.color||"#333"},navbarHeight(){return N(this.height)},leftIconWidth(){return N(this.leftWidth)},rightIconWidth(){return N(this.rightWidth)}},mounted(){uni.report&&this.stat&&""!==this.title&&uni.report("title",this.title)},methods:{onClickLeft(){this.$emit("clickLeft")},onClickRight(){this.$emit("clickRight")},onClickTitle(){this.$emit("clickTitle")}}},[["render",function(e,y,g,m,_,b){const k=r("status-bar"),v=$(o("uni-icons"),V),C=s,x=p;return t(),a(C,{class:c(["uni-navbar",{"uni-dark":g.dark,"uni-nvue-fixed":g.fixed}])},{default:l((()=>[d(C,{class:c(["uni-navbar__content",{"uni-navbar--fixed":g.fixed,"uni-navbar--shadow":g.shadow,"uni-navbar--border":g.border}]),style:n({"background-color":b.themeBgColor})},{default:l((()=>[g.statusBar?(t(),a(k,{key:0})):u("",!0),d(C,{style:n({color:b.themeColor,backgroundColor:b.themeBgColor,height:b.navbarHeight}),class:"uni-navbar__header"},{default:l((()=>[d(C,{onClick:b.onClickLeft,class:"uni-navbar__header-btns uni-navbar__header-btns-left",style:n({width:b.leftIconWidth})},{default:l((()=>[i(e.$slots,"left",{},(()=>[g.leftIcon.length>0?(t(),a(C,{key:0,class:"uni-navbar__content_view"},{default:l((()=>[d(v,{color:b.themeColor,type:g.leftIcon,size:"20"},null,8,["color","type"])])),_:1})):u("",!0),g.leftText.length?(t(),a(C,{key:1,class:c([{"uni-navbar-btn-icon-left":!g.leftIcon.length>0},"uni-navbar-btn-text"])},{default:l((()=>[d(x,{style:n({color:b.themeColor,fontSize:"12px"})},{default:l((()=>[h(f(g.leftText),1)])),_:1},8,["style"])])),_:1},8,["class"])):u("",!0)]),!0)])),_:3},8,["onClick","style"]),d(C,{class:"uni-navbar__header-container",onClick:b.onClickTitle},{default:l((()=>[i(e.$slots,"default",{},(()=>[g.title.length>0?(t(),a(C,{key:0,class:"uni-navbar__header-container-inner"},{default:l((()=>[d(x,{class:"uni-nav-bar-text uni-ellipsis-1",style:n({color:b.themeColor})},{default:l((()=>[h(f(g.title),1)])),_:1},8,["style"])])),_:1})):u("",!0)]),!0)])),_:3},8,["onClick"]),d(C,{onClick:b.onClickRight,class:"uni-navbar__header-btns uni-navbar__header-btns-right",style:n({width:b.rightIconWidth})},{default:l((()=>[i(e.$slots,"right",{},(()=>[g.rightIcon.length?(t(),a(C,{key:0},{default:l((()=>[d(v,{color:b.themeColor,type:g.rightIcon,size:"22"},null,8,["color","type"])])),_:1})):u("",!0),g.rightText.length&&!g.rightIcon.length?(t(),a(C,{key:1,class:"uni-navbar-btn-text"},{default:l((()=>[d(x,{class:"uni-nav-bar-right-text",style:n({color:b.themeColor})},{default:l((()=>[h(f(g.rightText),1)])),_:1},8,["style"])])),_:1})):u("",!0)]),!0)])),_:3},8,["onClick","style"])])),_:3},8,["style"])])),_:3},8,["class","style"]),g.fixed?(t(),a(C,{key:0,class:"uni-navbar__placeholder"},{default:l((()=>[g.statusBar?(t(),a(k,{key:0})):u("",!0),d(C,{class:"uni-navbar__placeholder-view",style:n({height:b.navbarHeight})},null,8,["style"])])),_:1})):u("",!0)])),_:3},8,["class"])}],["__scopeId","data-v-e825e9eb"]]),O={en:{"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"Search enter content"},"zh-Hans":{"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"请输入搜索内容"},"zh-Hant":{"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"請輸入搜索內容"}},{t:M}=y(O);const E=U({name:"UniSearchBar",emits:["input","update:modelValue","clear","cancel","confirm","blur","focus"],props:{placeholder:{type:String,default:""},radius:{type:[Number,String],default:5},clearButton:{type:String,default:"auto"},cancelButton:{type:String,default:"auto"},cancelText:{type:String,default:"取消"},bgColor:{type:String,default:"#F8F8F8"},maxlength:{type:[Number,String],default:100},value:{type:[Number,String],default:""},modelValue:{type:[Number,String],default:""},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},data:()=>({show:!1,showSync:!1,searchVal:""}),computed:{cancelTextI18n(){return this.cancelText||M("uni-search-bar.cancel")},placeholderText(){return this.placeholder||M("uni-search-bar.placeholder")}},watch:{modelValue:{immediate:!0,handler(e){this.searchVal=e,e&&(this.show=!0)}},focus:{immediate:!0,handler(e){if(e){if(this.readonly)return;this.show=!0,this.$nextTick((()=>{this.showSync=!0}))}}},searchVal(e,t){this.$emit("input",e),this.$emit("update:modelValue",e)}},methods:{searchClick(){this.readonly||this.show||(this.show=!0,this.$nextTick((()=>{this.showSync=!0})))},clear(){this.$emit("clear",{value:this.searchVal}),this.searchVal=""},cancel(){this.readonly||(this.$emit("cancel",{value:this.searchVal}),this.searchVal="",this.show=!1,this.showSync=!1,g())},confirm(){g(),this.$emit("confirm",{value:this.searchVal})},blur(){g(),this.$emit("blur",{value:this.searchVal})},emitFocus(e){this.$emit("focus",e.detail)}}},[["render",function(e,r,c,y,g,_){const b=$(o("uni-icons"),V),k=s,v=m,C=p;return t(),a(k,{class:"uni-searchbar"},{default:l((()=>[d(k,{style:n({borderRadius:c.radius+"px",backgroundColor:c.bgColor}),class:"uni-searchbar__box",onClick:_.searchClick},{default:l((()=>[d(k,{class:"uni-searchbar__box-icon-search"},{default:l((()=>[i(e.$slots,"searchIcon",{},(()=>[d(b,{color:"#c0c4cc",size:"18",type:"search"})]),!0)])),_:3}),g.show||g.searchVal?(t(),a(v,{key:0,focus:g.showSync,disabled:c.readonly,placeholder:_.placeholderText,maxlength:c.maxlength,class:"uni-searchbar__box-search-input","confirm-type":"search",type:"text",modelValue:g.searchVal,"onUpdate:modelValue":r[0]||(r[0]=e=>g.searchVal=e),onConfirm:_.confirm,onBlur:_.blur,onFocus:_.emitFocus},null,8,["focus","disabled","placeholder","maxlength","modelValue","onConfirm","onBlur","onFocus"])):(t(),a(C,{key:1,class:"uni-searchbar__text-placeholder"},{default:l((()=>[h(f(c.placeholder),1)])),_:1})),g.show&&("always"===c.clearButton||"auto"===c.clearButton&&""!==g.searchVal)&&!c.readonly?(t(),a(k,{key:2,class:"uni-searchbar__box-icon-clear",onClick:_.clear},{default:l((()=>[i(e.$slots,"clearIcon",{},(()=>[d(b,{color:"#c0c4cc",size:"20",type:"clear"})]),!0)])),_:3},8,["onClick"])):u("",!0)])),_:3},8,["style","onClick"]),"always"===c.cancelButton||g.show&&"auto"===c.cancelButton?(t(),a(C,{key:0,onClick:_.cancel,class:"uni-searchbar__cancel"},{default:l((()=>[h(f(_.cancelTextI18n),1)])),_:1},8,["onClick"])):u("",!0)])),_:3})}],["__scopeId","data-v-298b95e8"]]);const J=U({components:{},data:()=>({myInfo:{},friend:[],friendApply:[],fids:[],search:{},upUrl:"",adduinfo:{}}),onLoad(e){this.myInfo=_().globalData.myAuth,this.upUrl=_().globalData.upUrl},onShow:function(){_().globalData.myAuth.uid?(this.myInfo=_().globalData.myAuth,this.getMyFriend()):b({url:"/pages/member/index"})},onHide:function(){},methods:{setFriendRefuse(e){let t={},a=this;t.uid=this.friendApply[e].uid,W(_().globalData.eyUrl+"friend/refuse",t).then((t=>{let l=t.data;"1"==l.code?a.friendApply.splice(e,1):k({icon:"none",title:l.msg})}))},setFriendAgree(e){let t={},a=this;t.uid=this.friendApply[e].uid,W(_().globalData.eyUrl+"friend/agree",t).then((t=>{let l=t.data;"1"==l.code?(a.friendApply.splice(e,1),a.getMyFriend()):k({icon:"none",title:l.msg})}))},setFriendDel(e){let t=this;v({content:"确定要删除该好友吗？",success:function(a){if(a.confirm){let a={};a.uid=e.uid,W(_().globalData.eyUrl+"friend/del",a).then((e=>{let a=e.data;"1"==a.code?(t.$refs.showUserDetail.close(),k({title:"删除成功"}),t.getMyFriend()):k({icon:"none",title:a.msg})}))}}})},setFriendAdd(e){let t={},a=this;t.uid=e.uid,W(_().globalData.eyUrl+"friend/add",t).then((e=>{let t=e.data;"1"==t.code?(k({title:t.msg}),"1"==t.step&&a.getMyFriend(),a.search={}):k({icon:"none",title:t.msg})}))},openFriendAdd(e){this.search={};let t={},a=this;t.name=e.value,W(_().globalData.eyUrl+"friend/search",t).then((e=>{let t=e.data;"1"==t.code?a.search.data=t.data:k({icon:"none",title:t.msg})}))},renderFriendAdd(){this.$refs.showFriendAdd.open()},friendSearch(e){let t=[];if(""==e.detail.value)t=C("finfo")||[];else for(let a=0;a<this.friend.length;a++)this.friend[a].name.indexOf(e.detail.value)>=0&&t.push(this.friend[a]);this.friend=t},clickFriendDetail(e,t){this.$refs.showFriendAdd.close(),this.adduinfo=t,this.$refs.showUserDetail.open()},setFriendChat(e){this.$refs.showUserDetail.close(),x({url:"/pages/chat/chat?type=friend&rid="+e.uid+"&title="+e.name})},getMyFriend(){let e=this;W(_().globalData.eyUrl+"friend/getData",{}).then((t=>{let a=t.data;if("1"==a.code){let t=[],l=[];if(e.friend=[],e.friendApply=[],a.data.length>0){for(let n=0;n<a.data.length;n++)"1"==a.data[n].status&&a.data[n].uid==e.myInfo.uid?t.push(a.data[n].fid):"1"==a.data[n].status&&a.data[n].fid==e.myInfo.uid?t.push(a.data[n].uid):l.push(a.data[n].uid);let i=t.filter((function(e,a){return t.indexOf(e)===a}));for(let t=0;t<a.uinfo.length;t++)i.indexOf(a.uinfo[t].uid)>=0&&e.friend.push(a.uinfo[t]),l.indexOf(a.uinfo[t].uid)>=0&&e.friendApply.push(a.uinfo[t]);e.fids=i,w("fids",i),w("finfo",e.friend)}}else k({icon:"none",title:a.msg})}))}}},[["render",function(e,i,n,r,c,y){const g=p,_=s,b=$(o("uni-icons"),V),k=m,v=$(o("uni-badge"),D),C=$(o("uni-nav-bar"),L),x=$(o("uni-search-bar"),E),w=$(o("uni-list-chat"),T),U=$(o("uni-list"),j),W=$(o("uni-card"),z),N=$(o("uni-section"),H),O=I,M=$(o("uni-drawer"),R),J=A;return t(),F(S,null,[d(C,{onClickRight:y.renderFriendAdd},{left:l((()=>[d(_,{class:"city"},{default:l((()=>[d(_,null,{default:l((()=>[d(g,{style:{"font-size":"16px"}},{default:l((()=>[h("查好友")])),_:1})])),_:1})])),_:1})])),right:l((()=>[c.friendApply.length>0?(t(),a(v,{key:0,class:"uni-badge-left-margin",text:c.friendApply.length,absolute:"rightTop",offset:[30,3],size:"small"},{default:l((()=>[d(b,{type:"personadd-filled",color:"#666",size:"26"})])),_:1},8,["text"])):(t(),a(b,{key:1,type:"personadd-filled",color:"#666",size:"26"}))])),default:l((()=>[d(_,{class:"input-view"},{default:l((()=>[d(b,{class:"input-uni-icon",type:"search",size:"18",color:"#999"}),d(k,{"confirm-type":"search",class:"nav-bar-input",type:"text",placeholder:"输入好友昵称",onInput:y.friendSearch},null,8,["onInput"])])),_:1})])),_:1},8,["onClickRight"]),d(M,{ref:"showFriendAdd",mode:"right",width:260},{default:l((()=>[d(N,{title:"添加新的好友",type:"line"},{default:l((()=>[d(x,{placeholder:"请输入要添加好友的昵称",onConfirm:y.openFriendAdd,focus:!0,modelValue:c.search.value,"onUpdate:modelValue":i[0]||(i[0]=e=>c.search.value=e)},null,8,["onConfirm","modelValue"]),c.search.data&&c.search.data.length>0?(t(),a(U,{key:0},{default:l((()=>[d(U,{border:!0},{default:l((()=>[(t(!0),F(S,null,B(c.search.data,((e,l)=>(t(),a(w,{key:l,clickable:"",onClick:t=>y.clickFriendDetail("friend",e),"avatar-circle":!0,title:e.name,avatar:c.upUrl+e.avatar,note:e.sign,showArrow:""},null,8,["onClick","title","avatar","note"])))),128))])),_:1})])),_:1})):(t(),F(S,{key:1},[c.search.value&&""!=c.search.value?(t(),a(W,{key:0,style:{"background-color":"wheat",margin:"20rpx"}},{default:l((()=>[d(_,null,{default:l((()=>[d(g,{class:"uni-h6"},{default:l((()=>[h("没有找到该昵称的用户")])),_:1})])),_:1})])),_:1})):u("",!0)],64))])),_:1}),c.friendApply.length>0?(t(),a(N,{key:0,title:"申请加我为好友的用户",type:"line"},{default:l((()=>[d(_,{class:"loan_list"},{default:l((()=>[(t(!0),F(S,null,B(c.friendApply,((e,i)=>(t(),a(_,{class:"list_item",key:i},{default:l((()=>[d(_,{class:"item_head"},{default:l((()=>[d(O,{class:"pic",src:c.upUrl+e.avatar,mode:""},null,8,["src"]),d(_,{class:"loan_info"},{default:l((()=>[d(_,{class:"name"},{default:l((()=>[h(f(e.name),1)])),_:2},1024),e.sign&&""!=e.sign?(t(),a(_,{key:0,class:"date"},{default:l((()=>[h(f(e.sign),1)])),_:2},1024)):u("",!0)])),_:2},1024),d(_,{style:{"background-color":"orange"},class:"join_btn",onClick:e=>y.setFriendRefuse(i)},{default:l((()=>[h(" 拒绝 ")])),_:2},1032,["onClick"]),d(_,{class:"join_btn",onClick:e=>y.setFriendAgree(i)},{default:l((()=>[h(" 同意 ")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1})):u("",!0)])),_:1},512),d(M,{ref:"showUserDetail",mode:"right",width:260},{default:l((()=>[d(_,{class:"header"},{default:l((()=>[d(O,{src:c.upUrl+c.adduinfo.avatar},null,8,["src"])])),_:1}),d(_,{class:"list"},{default:l((()=>[d(_,{class:"list-call"},{default:l((()=>[h(" 用户昵称："+f(c.adduinfo.name),1)])),_:1}),c.adduinfo.sign&&""!=c.adduinfo.sign?(t(),a(_,{key:0,class:"list-call"},{default:l((()=>[h(f(c.adduinfo.sign),1)])),_:1})):u("",!0)])),_:1}),c.myInfo.uid!=c.adduinfo.uid?(t(),F(S,{key:0},[d(J,{style:{margin:"10px"},type:"primary",onClick:i[1]||(i[1]=e=>y.setFriendChat(c.adduinfo))},{default:l((()=>[h("私 聊")])),_:1}),c.fids.indexOf(c.adduinfo.uid)<0?(t(),a(J,{key:0,style:{margin:"10px"},type:"primary",plain:"true",onClick:i[2]||(i[2]=e=>y.setFriendAdd(c.adduinfo))},{default:l((()=>[h("加为好友")])),_:1})):(t(),a(J,{key:1,style:{margin:"10px"},type:"warn",onClick:i[3]||(i[3]=e=>y.setFriendDel(c.adduinfo))},{default:l((()=>[h("删除好友")])),_:1}))],64)):u("",!0)])),_:1},512),d(_,{class:"container"},{default:l((()=>[c.friend.length>0?(t(),a(U,{key:0},{default:l((()=>[d(U,{border:!0},{default:l((()=>[(t(!0),F(S,null,B(c.friend,((e,l)=>(t(),a(w,{key:l,clickable:"",onClick:t=>y.clickFriendDetail("friend",e),"avatar-circle":!0,title:e.name,avatar:c.upUrl+e.avatar,note:e.sign,showArrow:""},null,8,["onClick","title","avatar","note"])))),128))])),_:1})])),_:1})):(t(),a(W,{key:1,"is-shadow":!1},{default:l((()=>[d(g,{class:"uni-body"},{default:l((()=>[h("暂无好友数据，请添加新的好友。")])),_:1})])),_:1}))])),_:1})],64)}],["__scopeId","data-v-447a3203"]]);export{J as default};
