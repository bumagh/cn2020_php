import{j as e,B as a,E as t,D as l,J as s,K as m,l as o,H as r,o as n,a as u,f as i,w as c,F as d,i as p,z as h,g as b,u as f,I as g}from"./index-be7fe8a3.js";import{g as y,p as v}from"./util.ff018e21.js";import{_}from"./_plugin-vue_export-helper.1b428a4d.js";const A=_({data:()=>({member:{},upUrl:e().globalData.upUrl}),onShow(){let e=a("myAuth")||{};Object.keys(e).length<1?t({url:"/pages/member/index"}):this.getMemberInfo()},onUnload(){},computed:{},methods:{upMyAuth(a){for(var t in a)e().globalData.myAuth[t]=a[t];l("myAuth",e().globalData.myAuth)},upAvatar(){let a=this;s({count:1,sizeType:["compressed"],sourceType:["album"],success:function(t){console.log(JSON.stringify(t.tempFilePaths));let l=e().globalData.myAuth;m({header:{"Access-Token":l.uid+"|"+l.username+"|"+l.v+"|"+l.lvl},url:e().globalData.eyUrl+"attach/upimage",filePath:t.tempFilePaths[0],name:"file",formData:{module:"member"},success:e=>{var t=JSON.parse(e.data),l={};l.avatar=t.thumb,a.upMyAuth(l),a.member.avatar=l.avatar}})}})},getMemberInfo(){let a=this;y(e().globalData.eyUrl+"member/getProfile").then((e=>{let t=e.data;"1"==t.code?(a.member=t.data,l("myInfo",t.data)):o({icon:"none",title:t.msg})}))},editProfile(){if(String(this.member.name).length<2||String(this.member.name).length>20)return void o({icon:"none",title:"昵称字数在2-20位之间"});let a=this;v(e().globalData.eyUrl+"member/setProfile",this.member).then((e=>{let t=e.data;if("1"==t.code){o({icon:"none",title:"个人资料修改成功"});var l={};l.name=a.member.name,l.avatar=a.member.avatar,l.sign=a.member.sign,a.upMyAuth(l),setTimeout((function(){r()}),1500)}else o({icon:"none",title:t.msg})}))}}},[["render",function(e,a,t,l,s,m){const o=f,r=p,y=g,v=h;return n(),u(d,null,[i(r,{class:"content"},{default:c((()=>[i(r,{class:"header",onClick:a[0]||(a[0]=e=>m.upAvatar())},{default:c((()=>[i(o,{src:s.upUrl+s.member.avatar},null,8,["src"])])),_:1}),i(r,{class:"list"},{default:c((()=>[i(r,{class:"list-call"},{default:c((()=>[b(" 我的称呼： "),i(y,{class:"sl-input",modelValue:s.member.name,"onUpdate:modelValue":a[1]||(a[1]=e=>s.member.name=e),type:"text",placeholder:"修改您的称呼"},null,8,["modelValue"])])),_:1}),i(r,{class:"list-call"},{default:c((()=>[b(" 绑定手机： "),i(y,{class:"sl-input",modelValue:s.member.phone,"onUpdate:modelValue":a[2]||(a[2]=e=>s.member.phone=e),type:"number",maxlength:"11",placeholder:"绑定您的手机号码"},null,8,["modelValue"])])),_:1}),i(r,{class:"list-call"},{default:c((()=>[b(" 联系方式： "),i(y,{class:"sl-input",modelValue:s.member.contact,"onUpdate:modelValue":a[3]||(a[3]=e=>s.member.contact=e),type:"text",placeholder:"请输入联系方式"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),i(v,{type:"primary",onClick:m.editProfile},{default:c((()=>[b("修 改")])),_:1},8,["onClick"])],64)}],["__scopeId","data-v-5ddca04b"]]);export{A as default};
