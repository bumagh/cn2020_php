import{af as t,j as e,G as s,D as l,x as i,l as a,L as o,ag as r,ah as n,B as c,k as u,J as g,K as d,s as h,m,ai as f,aj as p,ad as k,ak as y,o as w,c as T,w as v,i as b,f as _,d as x,a as D,b as M,F as A,g as L,t as C,e as S,a5 as E,u as j,A as O,h as I,z as U,p as R,S as F,N as V,al as N,v as P}from"./index-be7fe8a3.js";import{_ as H,a as J}from"./uni-grid.e93a140d.js";import{r as $}from"./uni-app.es.63fa007f.js";import{_ as B}from"./uni-drawer.7c790caa.js";import{p as z}from"./util.ff018e21.js";import{_ as Y}from"./_plugin-vue_export-helper.1b428a4d.js";const G=""+new URL("chat-c9b6fce6.png",import.meta.url).href;const q=Y({data:()=>({socketTask:null,socketOpen:!1,socketAuth:{},upUrl:"",init:!1,member:[],memberOne:{},fids:[],textMsg:"",isHistoryLoading:!1,scrollAnimation:!1,scrollTop:0,scrollToView:"",msgList:[],msgImgList:[],isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:t(),playMsgid:null,VoiceTimer:null,popupLayerClass:"",hideMore:!0,hideEmoji:!0,emojiList:[[{url:"100.gif",alt:"[微笑]"},{url:"101.gif",alt:"[伤心]"},{url:"102.gif",alt:"[美女]"},{url:"103.gif",alt:"[发呆]"},{url:"104.gif",alt:"[墨镜]"},{url:"105.gif",alt:"[哭]"},{url:"106.gif",alt:"[羞]"},{url:"107.gif",alt:"[哑]"},{url:"108.gif",alt:"[睡]"},{url:"109.gif",alt:"[哭]"},{url:"110.gif",alt:"[囧]"},{url:"111.gif",alt:"[怒]"},{url:"112.gif",alt:"[调皮]"},{url:"113.gif",alt:"[笑]"},{url:"114.gif",alt:"[惊讶]"},{url:"115.gif",alt:"[难过]"},{url:"116.gif",alt:"[酷]"},{url:"117.gif",alt:"[汗]"},{url:"118.gif",alt:"[抓狂]"},{url:"119.gif",alt:"[吐]"},{url:"120.gif",alt:"[笑]"},{url:"121.gif",alt:"[快乐]"},{url:"122.gif",alt:"[奇]"},{url:"123.gif",alt:"[傲]"}],[{url:"124.gif",alt:"[饿]"},{url:"125.gif",alt:"[累]"},{url:"126.gif",alt:"[吓]"},{url:"127.gif",alt:"[汗]"},{url:"128.gif",alt:"[高兴]"},{url:"129.gif",alt:"[闲]"},{url:"130.gif",alt:"[努力]"},{url:"131.gif",alt:"[骂]"},{url:"132.gif",alt:"[疑问]"},{url:"133.gif",alt:"[秘密]"},{url:"134.gif",alt:"[乱]"},{url:"135.gif",alt:"[疯]"},{url:"136.gif",alt:"[哀]"},{url:"137.gif",alt:"[鬼]"},{url:"138.gif",alt:"[打击]"},{url:"139.gif",alt:"[bye]"},{url:"140.gif",alt:"[汗]"},{url:"141.gif",alt:"[抠]"},{url:"142.gif",alt:"[鼓掌]"},{url:"143.gif",alt:"[糟糕]"},{url:"144.gif",alt:"[恶搞]"},{url:"145.gif",alt:"[什么]"},{url:"146.gif",alt:"[什么]"},{url:"147.gif",alt:"[累]"}],[{url:"148.gif",alt:"[看]"},{url:"149.gif",alt:"[难过]"},{url:"150.gif",alt:"[难过]"},{url:"151.gif",alt:"[坏]"},{url:"152.gif",alt:"[亲]"},{url:"153.gif",alt:"[吓]"},{url:"154.gif",alt:"[可怜]"},{url:"155.gif",alt:"[刀]"},{url:"156.gif",alt:"[水果]"},{url:"157.gif",alt:"[酒]"},{url:"158.gif",alt:"[篮球]"},{url:"159.gif",alt:"[乒乓]"},{url:"160.gif",alt:"[咖啡]"},{url:"161.gif",alt:"[美食]"},{url:"162.gif",alt:"[动物]"},{url:"163.gif",alt:"[鲜花]"},{url:"164.gif",alt:"[枯]"},{url:"165.gif",alt:"[唇]"},{url:"166.gif",alt:"[爱]"},{url:"167.gif",alt:"[分手]"},{url:"168.gif",alt:"[生日]"},{url:"169.gif",alt:"[电]"},{url:"170.gif",alt:"[炸弹]"},{url:"171.gif",alt:"[刀子]"}],[{url:"172.gif",alt:"[足球]"},{url:"173.gif",alt:"[瓢虫]"},{url:"174.gif",alt:"[翔]"},{url:"175.gif",alt:"[月亮]"},{url:"176.gif",alt:"[太阳]"},{url:"177.gif",alt:"[礼物]"},{url:"178.gif",alt:"[抱抱]"},{url:"179.gif",alt:"[拇指]"},{url:"180.gif",alt:"[贬低]"},{url:"181.gif",alt:"[握手]"},{url:"182.gif",alt:"[剪刀手]"},{url:"183.gif",alt:"[抱拳]"},{url:"184.gif",alt:"[勾引]"},{url:"185.gif",alt:"[拳头]"},{url:"186.gif",alt:"[小拇指]"},{url:"187.gif",alt:"[拇指八]"},{url:"188.gif",alt:"[食指]"},{url:"189.gif",alt:"[ok]"},{url:"190.gif",alt:"[情侣]"},{url:"191.gif",alt:"[爱心]"},{url:"192.gif",alt:"[蹦哒]"},{url:"193.gif",alt:"[颤抖]"},{url:"194.gif",alt:"[怄气]"},{url:"195.gif",alt:"[跳舞]"}],[{url:"196.gif",alt:"[发呆]"},{url:"197.gif",alt:"[背着]"},{url:"198.gif",alt:"[伸手]"},{url:"199.gif",alt:"[耍帅]"},{url:"200.png",alt:"[微笑]"},{url:"201.png",alt:"[生病]"},{url:"202.png",alt:"[哭泣]"},{url:"203.png",alt:"[吐舌]"},{url:"204.png",alt:"[迷糊]"},{url:"205.png",alt:"[瞪眼]"},{url:"206.png",alt:"[恐怖]"},{url:"207.png",alt:"[忧愁]"},{url:"208.png",alt:"[眨眉]"},{url:"209.png",alt:"[闭眼]"},{url:"210.png",alt:"[鄙视]"},{url:"211.png",alt:"[阴暗]"},{url:"212.png",alt:"[小鬼]"},{url:"213.png",alt:"[礼物]"},{url:"214.png",alt:"[拜佛]"},{url:"215.png",alt:"[力量]"},{url:"216.png",alt:"[金钱]"},{url:"217.png",alt:"[蛋糕]"},{url:"218.png",alt:"[彩带]"},{url:"219.png",alt:"[礼物]"}]],windowsState:"",redenvelopeData:{rid:null,from:null,face:null,blessing:null,money:null}}),onLoad(t){let a=JSON.parse(JSON.stringify(t)),o=0;if(o=parseInt(a.rid),o>0){this.socketAuth.type=a.type,this.socketAuth.rid=o,this.socketAuth.key="ey56",this.socketAuth.uid=e().globalData.myAuth.uid,this.socketAuth.lvl=e().globalData.myAuth.lvl,this.socketAuth.username=e().globalData.myAuth.username,this.socketAuth.v=e().globalData.myAuth.v,this.socketAuth.name=e().globalData.myAuth.name,this.socketAuth.avatar=e().globalData.myAuth.avatar,this.upUrl=e().globalData.upUrl;let t=a.title?a.title:"group"==a.type?"群聊":"私聊";s({title:t}),this.fids=l("fids")||[]}else i({url:"/pages/chat/index"})},onShow(){this.scrollTop=9999999,this.connectScoketInit()},onNavigationBarButtonTap(t){let s=this,l={};l=this.socketAuth,z(e().globalData.eyUrl+"chat/getMember",l).then((t=>{let e=t.data;"1"==e.code&&(s.member=e.data,s.$refs.showRight.open())}))},methods:{setFriendAdd(t){let s={},l=this;s.uid=t.uid,z(e().globalData.eyUrl+"friend/add",s).then((t=>{let e=t.data;"1"==e.code?(a({title:e.msg}),"1"==e.step&&l.getMyFriend(),l.search={}):a({icon:"none",title:e.msg})}))},onClickFriend(t){"group"==this.socketAuth.type&&(this.memberOne=t,this.$refs.showFriendDetail.open())},setFriendChat(t){t.uid!=this.socketAuth.uid?o({url:"/pages/chat/chat?type=friend&rid="+t.uid+"&title="+t.name}):a({icon:"none",title:"不能跟自己对话"})},onClickMember(t){let e=t.detail.index;this.member[e].uid!=this.socketAuth.uid&&(this.$refs.showRight.close(),this.onClickFriend(this.member[e]))},closeSetting(t){this.$refs.showRight.close()},connectScoketInit(){let t=this;this.socketTask=r({url:e().globalData.socket,success(t){}}),this.socketTask.onOpen((e=>{this.socketOpen=!0;let s={};s.auth=this.socketAuth,s.act="login",this.socketTask.send({data:JSON.stringify(s),async successs(){console.log("消息发送成功")}}),this.socketTask.onMessage((function(e){let s=JSON.parse(e.data);if(t.init=!0,"retLogin"==s.retAct)t.getMsgList();else if("retChat"==s.retAct){let e={type:"user"};e.msg=s.data,e.msg.id=s.data.id.toString(),t.screenMsg(e)}}))})),this.socketTask.onClose((function(){console.log("close")}))},closeSocket(){this.socketTask.close({success(t){this.socketOpen=!1,console.log("主动关闭成功------",t)},fail(t){console.log("关闭失败",t)}})},screenMsg(t){if("system"==t.type)switch(t.msg.tag){case"text":this.addSystemTextMsg(t);break;case"redEnvelope":this.addSystemRedEnvelopeMsg(t)}else if("user"==t.type){switch(t.msg.tag){case"text":this.addTextMsg(t);break;case"voice":this.addVoiceMsg(t);break;case"img":this.addImgMsg(t);break;case"redEnvelope":this.addRedEnvelopeMsg(t)}t.msg.userinfo.uid!=this.socketAuth.uid&&n()}this.$nextTick((function(){this.scrollToView="msg"+t.msg.id}))},loadHistory(t){if(this.isHistoryLoading)return;if(1==this.init)return void(this.init=!1);this.isHistoryLoading=!0,this.scrollAnimation=!1;let s=this.msgList[0].msg.id,l=[],i=this,a={};a.type=i.socketAuth.type,a.rid=i.socketAuth.rid,a.id=s,z(e().globalData.eyUrl+"chat/getData",a).then((t=>{let e=t.data;if("1"==e.code){let t={};for(let s in e.data)t={},t.type="user",t.msg=e.data[s],t.msg.userinfo=e.member[t.msg.uid],l.push(t);setTimeout((()=>{for(let t=0;t<l.length;t++){if("user"==l[t].type&&"img"==l[t].msg.tag){l[t].msg.content=i.setPicSize(l[t].msg.content);let e=i.upUrl+l[t].msg.content.replace("/thumb/","/image/");i.msgImgList.unshift(e)}else"user"==l[t].type&&"text"==l[t].msg.tag&&(l[t].msg.content=i.replaceEmoji(l[t].msg.content));i.msgList.unshift(l[t])}i.$nextTick((function(){i.scrollToView="msg"+s,i.$nextTick((function(){}))})),i.isHistoryLoading=l.length<15}),500)}}))},getMsgList(){let t=this,s={};s.type=t.socketAuth.type,s.rid=t.socketAuth.rid,z(e().globalData.eyUrl+"chat/getData",s).then((e=>{let i=e.data;if(0!=i.data.length)if("1"==i.code){if(1==t.init)if("group"==s.type){let t=c("localGroupNews")||[];t[s.rid]||(t[s.rid]={}),t[s.rid].created_at=i.date,l("localGroupNews",t)}else if("friend"==s.type){let t=c("localFriendNews")||{};t[s.rid]||(t[s.rid]={}),t[s.rid].created_at=i.date,l("localFriendNews",t)}let e=[];if(i.data.length>0){let s={};for(let t=0;t<i.data.length;t++)s={},s.type="user",s.msg=i.data[t],s.msg.userinfo=i.member[s.msg.uid],e.unshift(s);for(let l=0;l<e.length;l++)if("user"==e[l].type&&"img"==e[l].msg.tag){let s=t.upUrl+e[l].msg.content.replace("/thumb/","/image/");t.msgImgList.push(s),e[l].msg.content=t.setPicSize(e[l].msg.content)}else"user"==e[l].type&&"text"==e[l].msg.tag&&(e[l].msg.content=t.replaceEmoji(e[l].msg.content))}t.msgList=e,t.$nextTick((function(){t.scrollTop=99999,t.scrollAnimation=!1}))}else t.scrollAnimation=!1,a({icon:"none",title:i.msg});else t.scrollAnimation=!1}))},setPicSize:t=>t,showMore(){this.isVoice=!1,this.hideEmoji=!0,this.hideMore?(this.hideMore=!1,this.openDrawer()):this.hideDrawer()},openDrawer(){this.popupLayerClass="showLayer"},hideDrawer(){this.popupLayerClass="",setTimeout((()=>{this.hideMore=!0,this.hideEmoji=!0}),150)},chooseImage(){this.getImage("album")},camera(){this.getImage("camera")},handRedEnvelopes(){u({url:"HM-hand/HM-hand"}),this.hideDrawer()},getImage(t){this.hideDrawer();let s=this;g({count:1,sizeType:["compressed"],sourceType:["album"],success:function(t){let l=e().globalData.myAuth;d({header:{"Access-Token":l.uid+"|"+l.username+"|"+l.v+"|"+l.lvl},url:e().globalData.eyUrl+"attach/upimage",filePath:t.tempFilePaths[0],name:"file",formData:{module:"chat"},success:t=>{var l=JSON.parse(t.data);let i={};i.rid=s.socketAuth.rid,i.type=s.socketAuth.type,i.tag="img",i.content=l.thumb,z(e().globalData.eyUrl+"chat/setData",i).then((t=>{let e=t.data;if("1"==e.code){let t=e.data;s.sendMessage(t)}}))}})}})},chooseEmoji(){this.hideMore=!0,this.hideEmoji?(this.hideEmoji=!1,this.openDrawer()):this.hideDrawer()},addEmoji(t){this.textMsg+=t.alt},textareaFocus(){"showLayer"==this.popupLayerClass&&0==this.hideMore&&this.hideDrawer()},sendText(){if(this.hideDrawer(),!this.textMsg)return;let t=this,s={};s.rid=t.socketAuth.rid,s.type=t.socketAuth.type,s.tag="text",s.content=this.textMsg,z(e().globalData.eyUrl+"chat/setData",s).then((e=>{let s=e.data;if("1"==s.code){let e=s.data;t.textMsg="",t.sendMessage(e)}}))},replaceEmoji(t){return t.replace(/\[([^(\]|\[)]*)\]/g,((t,s)=>{for(let l=0;l<this.emojiList.length;l++){let s=this.emojiList[l];for(let l=0;l<s.length;l++){let i=s[l];if(i.alt==t){return'<img src="'+(e().globalData.upUrl+"images/emoji/")+i.url+'">'}}}}))},sendMessage(t){if(1==this.socketOpen){let e={act:"chat"};e.auth=this.socketAuth,e.data=t,this.socketTask.send({data:JSON.stringify(e),async successs(){console.log("消息发送成功")}})}},sendMsg(t,e){if(1==this.socketOpen){let e={};e=this.socketAuth,e.act="chat",e.content=t,this.socketTask.send({data:JSON.stringify(e),async successs(){}})}},addTextMsg(t){"user"==t.type&&"text"==t.msg.tag&&(t.msg.content=this.replaceEmoji(t.msg.content)),this.msgList.push(t)},addVoiceMsg(t){this.msgList.push(t)},addImgMsg(t){t.msg.content=this.setPicSize(t.msg.content);let e=this.upUrl+t.msg.content.replace("/thumb/","/image/");this.msgImgList.push(e),this.msgList.push(t)},addRedEnvelopeMsg(t){this.msgList.push(t)},addSystemTextMsg(t){this.msgList.push(t)},addSystemRedEnvelopeMsg(t){this.msgList.push(t)},openRedEnvelope(t,e){let s=t.content.rid;h({title:"加载中..."}),console.log("index: "+e),setTimeout((()=>{0==s?this.redenvelopeData={rid:0,from:"大黑哥",face:"/static/img/im/face/face.jpg",blessing:"恭喜发财，大吉大利",money:"已领完"}:(this.redenvelopeData={rid:1,from:"售后客服008",face:"/static/img/im/face/face_2.jpg",blessing:"恭喜发财",money:"0.01"},t.content.isReceived||(this.sendSystemMsg({text:"你领取了"+(t.userinfo.uid==this.socketAuth.uid?"自己":t.userinfo.username)+"的红包"},"redEnvelope"),console.log("this.msgList[index]: "+JSON.stringify(this.msgList[e])),this.msgList[e].msg.content.isReceived=!0)),m(),this.windowsState="show"}),200)},closeRedEnvelope(){this.windowsState="hide",setTimeout((()=>{this.windowsState=""}),200)},sendSystemMsg(t,e){let s=this.msgList[this.msgList.length-1].msg.id;s++;let l={type:"system",msg:{id:s,type:e,content:t}};this.screenMsg(l)},toDetails(t){u({url:"HM-details/HM-details?rid="+t})},showPic(t){f({indicator:"none",current:this.upUrl+t.content,urls:this.msgImgList})},showTextTools(t){let s=t.content,l=this;p({itemList:["复制转发","引用"],success:function(t){if(0==t.tapIndex)k({data:s,success:function(){a({title:"复制成功"})}});else if(1==t.tapIndex){let t="";if(-1!==s.indexOf("<img")){let i=e().globalData.upUrl,a=[],o=[];for(let t=0;t<5;t++)for(let e=0;e<l.emojiList[t].length;e++)a.push(l.emojiList[t][e].alt),o.push(l.emojiList[t][e].url);t=s.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi,(function(t,e){let s=e.replace(i+"images/emoji/","");return a[o.indexOf(s)]}))}else t=s;l.textMsg=t}},fail:function(t){console.log(t.errMsg)}})},playVoice(t){this.playMsgid=t.id,this.AUDIO.src=t.content,this.$nextTick((function(){this.AUDIO.play()}))},voiceBegin(t){t.touches.length>1||(this.initPoint.Y=t.touches[0].clientY,this.initPoint.identifier=t.touches[0].identifier,this.RECORDER.start({format:"mp3"}))},recordBegin(t){this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((()=>{this.recordLength++}),1e3)},voiceCancel(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng(t){if(!this.recording)return;let e=t.touches[0];this.initPoint.Y-e.clientY>=y(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")},voiceEnd(t){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd(t){if(clearInterval(this.recordTimer),this.willStop)console.log("取消发送录音");else{console.log("e: "+JSON.stringify(t));let e={length:0,url:t.tempFilePath},s=parseInt(this.recordLength/60),l=this.recordLength%60;s=s<10?"0"+s:s,l=l<10?"0"+l:l,e.length=s+":"+l,this.sendMsg(e,"voice")}this.willStop=!1},switchVoice(){this.hideDrawer(),this.isVoice=!this.isVoice},discard(){}}},[["render",function(t,e,s,l,i,a){const o=b,r=N,n=j,c=O,u=I,g=U,d=$(R("uni-grid-item"),H),h=$(R("uni-grid"),J),m=$(R("uni-drawer"),B),f=P,p=F,k=V;return w(),T(o,null,{default:v((()=>[_(o,{class:"content",onTouchstart:a.hideDrawer},{default:v((()=>[_(c,{class:"msg-list","scroll-y":"true","scroll-with-animation":i.scrollAnimation,"scroll-top":i.scrollTop,"scroll-into-view":i.scrollToView,onScrolltoupper:a.loadHistory,"upper-threshold":"500"},{default:v((()=>[i.scrollAnimation?(w(),T(o,{key:0,class:"loading"},{default:v((()=>[_(o,{class:"spinner"},{default:v((()=>[_(o,{class:"rect1"}),_(o,{class:"rect2"}),_(o,{class:"rect3"}),_(o,{class:"rect4"}),_(o,{class:"rect5"})])),_:1})])),_:1})):x("",!0),(w(!0),D(A,null,M(i.msgList,((t,e)=>(w(),T(o,{class:"row",key:e,id:"msg"+t.msg.id},{default:v((()=>["user"==t.type?(w(),D(A,{key:0},[t.msg.userinfo.uid==i.socketAuth.uid?(w(),T(o,{key:0,class:"my"},{default:v((()=>[_(o,{class:"left"},{default:v((()=>["text"==t.msg.tag?(w(),T(o,{key:0,class:"bubble",onClick:e=>a.showTextTools(t.msg)},{default:v((()=>[_(r,{onItemclick:e=>a.showTextTools(t.msg),nodes:t.msg.content},null,8,["onItemclick","nodes"])])),_:2},1032,["onClick"])):x("",!0),"img"==t.msg.tag?(w(),T(o,{key:1,class:"bubble img",onClick:e=>a.showPic(t.msg)},{default:v((()=>[_(n,{src:i.upUrl+t.msg.content,style:{width:"200px",height:"100px"}},null,8,["src"])])),_:2},1032,["onClick"])):x("",!0)])),_:2},1024),_(o,{class:"right"},{default:v((()=>[_(n,{src:i.upUrl+t.msg.userinfo.avatar},null,8,["src"])])),_:2},1024)])),_:2},1024)):x("",!0),t.msg.userinfo.uid!=i.socketAuth.uid?(w(),T(o,{key:1,class:"other"},{default:v((()=>[_(o,{class:"left",onClick:e=>a.onClickFriend(t.msg.userinfo)},{default:v((()=>[_(n,{src:i.upUrl+t.msg.userinfo.avatar},null,8,["src"])])),_:2},1032,["onClick"]),_(o,{class:"right"},{default:v((()=>[_(o,{class:"username"},{default:v((()=>[_(o,{class:"name"},{default:v((()=>[L(C(t.msg.userinfo.name),1)])),_:2},1024),L(),_(o,{class:"time"},{default:v((()=>[L(C(t.msg.created_at),1)])),_:2},1024)])),_:2},1024),"text"==t.msg.tag?(w(),T(o,{key:0,class:"bubble",onClick:e=>a.showTextTools(t.msg)},{default:v((()=>[_(r,{onItemclick:e=>a.showTextTools(t.msg),nodes:t.msg.content},null,8,["onItemclick","nodes"])])),_:2},1032,["onClick"])):x("",!0),"img"==t.msg.tag?(w(),T(o,{key:1,class:"bubble img",onClick:e=>a.showPic(t.msg)},{default:v((()=>[_(n,{src:i.upUrl+t.msg.content,style:{width:"200px",height:"100px"}},null,8,["src"])])),_:2},1032,["onClick"])):x("",!0)])),_:2},1024)])),_:2},1024)):x("",!0)],64)):x("",!0)])),_:2},1032,["id"])))),128))])),_:1},8,["scroll-with-animation","scroll-top","scroll-into-view","onScrolltoupper"])])),_:1},8,["onTouchstart"]),_(m,{ref:"showRight",mode:"right",width:260},{default:v((()=>[_(o,{class:"scroll-view"},{default:v((()=>[_(c,{class:"scroll-view-box","scroll-y":"true"},{default:v((()=>[_(o,{class:"close"},{default:v((()=>[_(g,{onClick:e[0]||(e[0]=t=>a.closeSetting("showRight"))},{default:v((()=>[_(u,{class:"word-btn-white"},{default:v((()=>[L("关闭")])),_:1})])),_:1})])),_:1}),_(h,{column:3,showBorder:!1,highlight:!0,onChange:a.onClickMember},{default:v((()=>[(w(!0),D(A,null,M(i.member,((t,e)=>(w(),T(d,{index:e,key:e},{default:v((()=>[_(o,{class:"grid-item-box"},{default:v((()=>[_(n,{src:i.upUrl+t.avatar,class:"image",mode:"scaleToFill"},null,8,["src"]),_(u,{class:"text"},{default:v((()=>[L(C(t.name),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["index"])))),128))])),_:1},8,["onChange"])])),_:1})])),_:1})])),_:1},512),_(m,{ref:"showFriendDetail",mode:"right",width:260},{default:v((()=>[_(o,{class:"header"},{default:v((()=>[_(n,{src:i.upUrl+i.memberOne.avatar},null,8,["src"])])),_:1}),_(o,{class:"list"},{default:v((()=>[_(o,{class:"list-call"},{default:v((()=>[L(" 用户昵称："+C(i.memberOne.name),1)])),_:1})])),_:1}),_(g,{style:{margin:"20px"},type:"primary",onClick:e[1]||(e[1]=t=>a.setFriendChat(i.memberOne))},{default:v((()=>[L("私 聊")])),_:1}),i.fids.indexOf(i.memberOne.uid)<0?(w(),T(g,{key:0,style:{margin:"20px"},type:"primary",plain:"true",onClick:e[2]||(e[2]=t=>a.setFriendAdd(i.memberOne))},{default:v((()=>[L("加为好友")])),_:1})):x("",!0)])),_:1},512),_(o,{class:S(["popup-layer",i.popupLayerClass]),onTouchmove:E(a.discard,["stop","prevent"])},{default:v((()=>[_(p,{class:S(["emoji-swiper",{hidden:i.hideEmoji}]),"indicator-dots":"true",duration:"150"},{default:v((()=>[(w(!0),D(A,null,M(i.emojiList,((t,e)=>(w(),T(f,{key:e},{default:v((()=>[(w(!0),D(A,null,M(t,((t,e)=>(w(),T(o,{key:e,onClick:e=>a.addEmoji(t)},{default:v((()=>[_(n,{mode:"widthFix",src:"/static/HM-chat/emoji/"+t.url},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:2},1024)))),128))])),_:1},8,["class"]),_(o,{class:S(["more-layer",{hidden:i.hideMore}])},{default:v((()=>[_(o,{class:"list"},{default:v((()=>[_(o,{class:"box",onClick:a.chooseImage},{default:v((()=>[_(o,{class:"icon tupian2"})])),_:1},8,["onClick"])])),_:1})])),_:1},8,["class"])])),_:1},8,["class","onTouchmove"]),_(o,{class:S(["input-box",i.popupLayerClass]),onTouchmove:E(a.discard,["stop","prevent"])},{default:v((()=>[_(o,{class:"more",onClick:a.showMore},{default:v((()=>[_(o,{class:"icon add"})])),_:1},8,["onClick"]),_(o,{class:"textbox"},{default:v((()=>[_(o,{class:S(["voice-mode",[i.isVoice?"":"hidden",i.recording?"recording":""]]),onTouchstart:a.voiceBegin,onTouchmove:E(a.voiceIng,["stop","prevent"]),onTouchend:a.voiceEnd,onTouchcancel:a.voiceCancel},{default:v((()=>[L(C(i.voiceTis),1)])),_:1},8,["class","onTouchstart","onTouchmove","onTouchend","onTouchcancel"]),_(o,{class:S(["text-mode",i.isVoice?"hidden":""])},{default:v((()=>[_(o,{class:"box"},{default:v((()=>[_(k,{"auto-height":"true",modelValue:i.textMsg,"onUpdate:modelValue":e[3]||(e[3]=t=>i.textMsg=t),onFocus:a.textareaFocus},null,8,["modelValue","onFocus"])])),_:1}),_(o,{class:"em",onClick:a.chooseEmoji},{default:v((()=>[_(o,{class:"icon biaoqing"})])),_:1},8,["onClick"])])),_:1},8,["class"])])),_:1}),_(o,{class:S(["send",i.isVoice?"hidden":""]),onClick:a.sendText},{default:v((()=>[_(o,{class:"btn"},{default:v((()=>[L("发送")])),_:1})])),_:1},8,["class","onClick"])])),_:1},8,["class","onTouchmove"]),_(o,{class:S(["windows",i.windowsState])},{default:v((()=>[_(o,{class:"mask",onTouchmove:E(a.discard,["stop","prevent"]),onClick:a.closeRedEnvelope},null,8,["onTouchmove","onClick"]),_(o,{class:"layer",onTouchmove:E(a.discard,["stop","prevent"])},{default:v((()=>[_(o,{class:"open-redenvelope"},{default:v((()=>[_(o,{class:"top"},{default:v((()=>[_(o,{class:"close-btn"},{default:v((()=>[_(o,{class:"icon close",onClick:a.closeRedEnvelope},null,8,["onClick"])])),_:1}),_(n,{src:G})])),_:1}),_(o,{class:"from"},{default:v((()=>[L("来自"+C(i.redenvelopeData.from),1)])),_:1}),_(o,{class:"blessing"},{default:v((()=>[L(C(i.redenvelopeData.blessing),1)])),_:1}),_(o,{class:"money"},{default:v((()=>[L(C(i.redenvelopeData.money),1)])),_:1}),_(o,{class:"showDetails",onClick:e[4]||(e[4]=t=>a.toDetails(i.redenvelopeData.rid))},{default:v((()=>[L(" 查看领取详情 "),_(o,{class:"icon to"})])),_:1})])),_:1})])),_:1},8,["onTouchmove"])])),_:1},8,["class"])])),_:1})}],["__scopeId","data-v-420430bb"]]);export{q as default};
